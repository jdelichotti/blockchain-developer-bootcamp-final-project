# Final Project - SMARTBET

## Deployed version url:

https://ecstatic-jennings-d355b5.netlify.app/

## How to run this project locally:

### Prerequisites

- Node.js >= v14
- Truffle and Ganache
- `git checkout master`

### Setup
- Clone the repository in your local machine and install the dependencies
  
  1. git clone https://github.com/jdelichotti/blockchain-developer-bootcamp-final-project.git
  2. cd blockchain-developer-bootcamp-final-project/
  3. npm install
  4. code . -> Open VCode!
 
### Running the Test Cases
There are 7 TCs written in javascript. To execute them you must run the following commands:
1. truffle develop -> It creates the internal blockchain network to perform the testing
2. test --> It will compile the contracts and execute the Test Cases.

![image](https://user-images.githubusercontent.com/32246675/143797692-7ea03f25-8e2f-42fa-92d8-43666707c032.png)

  
### Deploy Frontend in the local environment

1. First of all we have to setup the blockhain network using ganache-cli
   truffle develop -> It creates the internal blockchain network to perform the testing
   
  ![image](https://user-images.githubusercontent.com/32246675/143800291-8225616d-b9f1-48ce-bcce-7b8bcbdb7b21.png)

2. Migrate the contract to the network
   **migrate**

3. Copy the smart contract address generated after execute migrate
   ![image](https://user-images.githubusercontent.com/32246675/143800636-dc0ec4f1-297f-4c28-907f-1e760c45c4ee.png)

4. Paste the address in the config.js file (/dapp-smartbet/config.js
5. Open a new console and navigate to dapp-smartbet folder
   cd dapp-smartnet
6. Execute the following commands:
   npm run dev
7. Go to http://localhost:3000

   ![image](https://user-images.githubusercontent.com/32246675/143801327-383a94da-8596-464e-8554-20516b5fd553.png)
    
   Dapp Up & Running


## Screencast link

https://loom.com/share/37254a33142a4b25af5aca3cc97d066a

## Public Ethereum wallet for certification:

`0x765644db490907f073B32C46Cc2470B40b849701`

## Project description

The dapp allows you to create new bets on soccer matches where the winners win the accumulated jackpot.
The application has two types of profiles:

Sponsors: People who, once the betting event has been created, provide liquidity to attract the interest of bettors at the beginning of the event. In return, the sponsors receive a commission for each bet (transaction) made by the bettors. The more bettors, the higher your profit.

Bettors: They place their bets by entering the result they think will happen in the match (Local Win, Visitor Win or Tie) and the amount of ETH they wish to bet. At the end of the bet, all winners share the prize proportionally between their bets and the sum of all bettors who won.

Finally, smartcontract keeps a commission on each transaction to cover its operating expenses (gas).


## Simple workflow

1. The owner of the contract generates a new bet by entering the two teams that are facing each other (the bet starts in a "bet Funding" status).
  --> Go to "Create Bet" page and using the Account[0] create the first soccer bet
2. The sponsors add liquidity to the bet. Once the minimum number of Sponsors is reached (set to 2) the bet goes to "Open" status so that bettors can place their bets.
  --> Go to "Bet" page and usding accounts [1] y [2] add liquidity to the bet. The status should change from BetFunding to Open.
  --> Moving to the "Bet Administration Bet" the detail button (blue) allows to check the liquidity generated by the Sponsors.
3. The bettors place their bets for the different results of the match (Local Win, Visitor Win or Tie).
  --> On the "Bet" the gamblers can star making bets on Local/Visitor/Tie result. I used Account[3]and [4].
4. When the closing time of the bet is reached, the application does not allow new bets to be placed. (Currently the bet is closed by the owner of the contract). The bet goes to "Closed" status.
  --> Go to "Bet Admin" and using the Owner account click the "Close" Button
5. The dapp reads information from an oracle to get the result of the match (currently the owner enters the result). Once the event is triggered, the application calculates the money taken by each participant (sponsors, gambler & dapp). The bet moves to "Releaase Payments" status.
  --> On the "Bet Admin" page ,using the Owner, account click the "Define Result" Button (1-Local, 2-Vistor, 3-Drawn)
6. The contract owner releases the payments and the bet is finished.
  --> On the same page release payment

## Directory structure

- `dapp-smartbet`: Project's React frontend.
- `contracts`: Smart contracts that are deployed in the Ropsten testnet.
- `migrations`: Migration files for deploying contracts in `contracts` directory.
- `test`: Tests for smart contracts.


## TODO features

- The closing bet event it could be implemented using the ethereum-alarm-clock project. (https://www.ethereum-alarm-clock.com/)
- Defining the bet results:Obtaining the outcome of the match can be achieved by using an Oracle or through a DAO scheme where consensus is reached between the various parties involved.
